<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to 1-way ANOVA: impacts of diet on deer antlers • wildlifeR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">wildlifeR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANOVA_deer_antlers.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/Inference_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/reporting_paired_t_test_results.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/reporting_t_test_results.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Intro to 1-way ANOVA: impacts of diet on deer antlers</h1>
                        <h4 class="author">Nathan Brouwer <a href="mailto:brouwern@gmail.com">brouwern@gmail.com</a> <span class="citation">@lobrowR</span>
</h4>
            
            <h4 class="date">2017-11-15</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The purpose of this lab is to learn the basics of 1-way ANOVA in R. We will explore data where white-tailed deer where fed different diets over the course of the spring and summer of one year.</p>
<ul>
<li>Diet 1: “Hi.Hi” = deer fed high protein diets during spring and summer</li>
<li>Diet 2: “Hi.Lo” = deer fed high quality diets during spring, but low quality diet during summer</li>
<li>Diet 3: “Lo.Hi” = deer fed low-protein diet during spring but high quality diet during summer.</li>
</ul>
<p>Note: there is no “Lo.Lo” treatment</p>
<p>Analyis with 1-way ANOVA will allow us to determine whether</p>
<ol style="list-style-type: decimal">
<li>All of the means are similar or if at least one differs</li>
<li>Which treatment, if any, is most likely impacting antler growth.</li>
</ol>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Data were simulated from summary parameters in:</p>
<p>Asleson et al. 1997. Effects of seasonal protein restriction on antlerogenesis and body mass in adult male white-tailed deer. Journal of Wildlife Management 61.</p>
<p>For more information see ?antlers</p>
</div>
</div>
<div id="part-1-summary-stats-plotting-means" class="section level2">
<h2 class="hasAnchor">
<a href="#part-1-summary-stats-plotting-means" class="anchor"></a>Part 1: Summary stats &amp; plotting means</h2>
<div id="summary-stats-on-all-data" class="section level3">
<h3 class="hasAnchor">
<a href="#summary-stats-on-all-data" class="anchor"></a>1) Summary stats on all data</h3>
<p>In this section the grand mean on ALL the data is calculated; data is NOT broken up by treatment! Data is considered by subgroup below</p>
<p>Load data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wildlifeR)
<span class="kw">data</span>(antlers)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># total sample size (all observations)</span>
<span class="kw">dim</span>(antlers)</code></pre></div>
<pre><code>## [1] 30  5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n.total &lt;-<span class="st"> </span><span class="kw">length</span>(antlers<span class="op">$</span>mass)

<span class="co">#mean of ALL samples</span>
<span class="kw">summary</span>(antlers)</code></pre></div>
<pre><code>##     diet         mass           circum            beam      
##  Hi.Hi:10   Min.   :346.0   Min.   : 57.95   Min.   :247.3  
##  Hi.Lo:10   1st Qu.:526.9   1st Qu.: 87.85   1st Qu.:392.9  
##  Lo.Hi:10   Median :648.4   Median : 96.67   Median :424.5  
##             Mean   :635.9   Mean   : 99.43   Mean   :412.0  
##             3rd Qu.:762.4   3rd Qu.:112.17   3rd Qu.:440.2  
##             Max.   :919.3   Max.   :136.06   Max.   :568.2  
##      spread     
##  Min.   :223.8  
##  1st Qu.:295.1  
##  Median :346.0  
##  Mean   :341.4  
##  3rd Qu.:383.5  
##  Max.   :459.7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(antlers<span class="op">$</span>mass)</code></pre></div>
<pre><code>## [1] 635.9164</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#variance of ALL samples</span>
<span class="kw">var</span>(antlers<span class="op">$</span>mass)</code></pre></div>
<pre><code>## [1] 25767.67</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#stdev of ALL samples</span>
mass.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(antlers<span class="op">$</span>mass)</code></pre></div>
</div>
<div id="standard-error-for-all-data" class="section level3">
<h3 class="hasAnchor">
<a href="#standard-error-for-all-data" class="anchor"></a>2) Standard error for all data</h3>
<p>This ignores treatments. All data are combined / pooled.</p>
<p>We’ll do this a couple different ways to show how R code can vary.</p>
<p>Broken up into steps, saving an object at each stuep</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#square root of N</span>
sqrt.n &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n.total)

<span class="co">#the see</span>
mass.se &lt;-<span class="st"> </span>mass.sd<span class="op">/</span>sqrt.n

mass.se</code></pre></div>
<pre><code>## [1] 29.30738</code></pre>
<p>Doing it a little “on fly”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass.se &lt;-<span class="st"> </span>mass.sd<span class="op">/</span><span class="kw">sqrt</span>(n.total)</code></pre></div>
<p>Totally on the fly - nothing pre-saved as an object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Using raw data</span>
mass.se &lt;-<span class="st"> </span><span class="kw">sd</span>(antlers<span class="op">$</span>mass)<span class="op">/</span>
<span class="st">             </span><span class="kw">sqrt</span>(<span class="kw">length</span>(antlers<span class="op">$</span>mass))</code></pre></div>
</div>
<div id="ci-for-all-data" class="section level3">
<h3 class="hasAnchor">
<a href="#ci-for-all-data" class="anchor"></a>3) 95% CI for all data</h3>
<p>This is the 95% confidence interval around the overall/grand mean. W approximate the CI as 1.96*SE</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">1.96</span><span class="op">*</span>mass.se</code></pre></div>
<pre><code>## [1] 57.44246</code></pre>
</div>
<div id="calcualte-summary-stats-for-each-group" class="section level3">
<h3 class="hasAnchor">
<a href="#calcualte-summary-stats-for-each-group" class="anchor"></a>4) Calcualte summary stats for each group</h3>
<ul>
<li>Calculae the mean for each diet treatment using dplyr.<br>
</li>
<li>THe group_by() function split it up by treatment</li>
<li>summarize() calcualtes the mean</li>
<li>Recall the “%&gt;%” is called a “pipe”</li>
</ul>
<p>See pages 70-73 in “Getting started with R: An INtroduction for Biologists” for information on summarize() and group_by(). In particular see section 3.7.3 on page 72: “Method 2: Pipe, no nesting”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

antlers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarize</span>(<span class="dt">mass.mean =</span> <span class="kw">mean</span>(mass))</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##     diet mass.mean
##   &lt;fctr&gt;     &lt;dbl&gt;
## 1  Hi.Hi  605.9653
## 2  Hi.Lo  561.9856
## 3  Lo.Hi  739.7984</code></pre>
<p>We can get the SD like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">antlers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarize</span>(<span class="dt">mass.sd =</span> <span class="kw">sd</span>(mass))</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##     diet  mass.sd
##   &lt;fctr&gt;    &lt;dbl&gt;
## 1  Hi.Hi 154.6435
## 2  Hi.Lo 134.9401
## 3  Lo.Hi 147.8019</code></pre>
<p>And the sample size like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">antlers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarize</span>(<span class="dt">mass.N =</span> <span class="kw">length</span>(mass))</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##     diet mass.N
##   &lt;fctr&gt;  &lt;int&gt;
## 1  Hi.Hi     10
## 2  Hi.Lo     10
## 3  Lo.Hi     10</code></pre>
<p>We can calcualte all of them like below. this time we’ll store the ouptut in an object “mass.means”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass.means &lt;-<span class="st"> </span>antlers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarize</span>(<span class="dt">mass.mean =</span> <span class="kw">mean</span>(mass),
             <span class="dt">mass.sd =</span> <span class="kw">sd</span>(mass),
             <span class="dt">mass.N =</span> <span class="kw">length</span>(mass))</code></pre></div>
</div>
<div id="calcualte-the-3-se-values" class="section level3">
<h3 class="hasAnchor">
<a href="#calcualte-the-3-se-values" class="anchor"></a>5) Calcualte the 3 SE values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass.SEs &lt;-<span class="st"> </span>mass.means<span class="op">$</span>mass.sd<span class="op">/</span><span class="kw">sqrt</span>(mass.means<span class="op">$</span>mass.N)</code></pre></div>
<p>Add them to the dataframme</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass.means<span class="op">$</span>mass.SEs &lt;-<span class="st"> </span>mass.SEs</code></pre></div>
<p>We can conver these to approximately 95% confidence intervals like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mass.means<span class="op">$</span>mass.CI95 &lt;-<span class="st"> </span>mass.means<span class="op">$</span>mass.SEs<span class="op">*</span><span class="fl">1.96</span></code></pre></div>
<p>What do you notice about the relationship between the SD, SE, and 95% CI?</p>
</div>
</div>
<div id="plot-the-3-mean-values" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-3-mean-values" class="anchor"></a>6) Plot the 3 mean values</h2>
<p>We’ll plot means using ggpubr. We’ll give the function ggerrorplot() the raw data and it will calculate the means etc to make the plot.</p>
<p>See the link below for more information <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/79-plot-meansmedians-and-error-bars/" class="uri">http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/79-plot-meansmedians-and-error-bars/</a></p>
<p>mean_se mean_sd mean_range</p>
<p>First, we’ll plot the means and their standard deviations SD</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr)

<span class="kw">ggerrorplot</span>(antlers, 
            <span class="dt">x =</span> <span class="st">"diet"</span>, 
            <span class="dt">y =</span> <span class="st">"mass"</span>, 
            <span class="dt">desc_stat =</span> <span class="st">"mean_sd"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>
            )</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
<p>Next we’ll plot the standard errors. What happens to the x-axis?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggerrorplot</span>(antlers, 
            <span class="dt">x =</span> <span class="st">"diet"</span>, 
            <span class="dt">y =</span> <span class="st">"mass"</span>, 
            <span class="dt">desc_stat =</span> <span class="st">"mean_se"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>
            )</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-15-1.png" width="480"></p>
<p>We can make a plot with both if we save the plots to R objects. We’ll use the argument ylim = c(400,1000) to make it so they both have the same y axes</p>
<p>Note: We’ll need to load the gridExtra package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"gridExtra"</span>)
plot1 &lt;-<span class="st"> </span><span class="kw">ggerrorplot</span>(antlers, 
            <span class="dt">x =</span> <span class="st">"diet"</span>, 
            <span class="dt">y =</span> <span class="st">"mass"</span>, 
            <span class="dt">desc_stat =</span> <span class="st">"mean_sd"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>,
            <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">400</span>,<span class="dv">900</span>) <span class="co">#set axes</span>
            )

plot2 &lt;-<span class="st"> </span><span class="kw">ggerrorplot</span>(antlers, 
            <span class="dt">x =</span> <span class="st">"diet"</span>, 
            <span class="dt">y =</span> <span class="st">"mass"</span>, 
            <span class="dt">desc_stat =</span> <span class="st">"mean_se"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>,
            <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">400</span>,<span class="dv">900</span>) <span class="co">#set axes</span>
            )</code></pre></div>
<p>Plot both plots. What do you notice about the standard errors?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(plot1,plot2)</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
<p>We can also easily make a plot using confience intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggerrorplot</span>(antlers, 
            <span class="dt">x =</span> <span class="st">"diet"</span>, 
            <span class="dt">y =</span> <span class="st">"mass"</span>, 
            <span class="dt">desc_stat =</span> <span class="st">"mean_ci"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>,
            <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">400</span>,<span class="dv">900</span>) <span class="co">#set axes</span>
            )</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
<p><strong>We have not calculated any p-values yet, but can you use the “inference by eye” approach to judge whether any of the means are likely to be “significantly” different based on the 95% confidence intervals?</strong></p>
</div>
<div id="part-2-omnibus-anova-test" class="section level2">
<h2 class="hasAnchor">
<a href="#part-2-omnibus-anova-test" class="anchor"></a>Part 2: Omnibus ANOVA test</h2>
<p>An “omnibus ANOVA test” (or “omnibus F test”) is used to gauge whether all the means are approximatley equal or whether at least one is likely to be different than the others. “Omnibus” means “overall”.</p>
<div id="build-the-null-ho-and-alternative-ha-models" class="section level3">
<h3 class="hasAnchor">
<a href="#build-the-null-ho-and-alternative-ha-models" class="anchor"></a>7 &amp; 8) Build the null (Ho) and alternative (Ha) models</h3>
<p>We build a null modle represent the null hypothesis that there is no difference between the any of the groups. Not that we code “mass ~ 1” to represent this null model, which has just a single mean value for all of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model.null &lt;-<span class="st"> </span><span class="kw">lm</span>(mass <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, 
                 <span class="dt">data =</span> antlers)</code></pre></div>
<p>We buidl an alternative model or “model of interest” to test the hypothesis we are interested in: that diet impacts antler growth in some way. This model will have 3 means: one for each treatment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model.alt &lt;-<span class="st"> </span><span class="kw">lm</span>(mass <span class="op">~</span><span class="st"> </span>diet, 
                 <span class="dt">data =</span> antlers)</code></pre></div>
</div>
</div>
<div id="conduct-the-omnibus-test-and-get-the-anova-output" class="section level2">
<h2 class="hasAnchor">
<a href="#conduct-the-omnibus-test-and-get-the-anova-output" class="anchor"></a>9-12) Conduct the Omnibus test and get the ANOVA output</h2>
<p>Produce the ANOVA table using the anova() command. This will give us the F statistics (the test statistics for ANOVA), degrees of freedom, and our p-values. (It will also give us some other info that we’ll ignore for now but that is typically reported when you do an ANOAV)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(model.null,
      model.alt)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mass ~ 1
## Model 2: mass ~ diet
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1     29 747262                              
## 2     27 575719  2    171543 4.0225 0.02958 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div id="optional" class="section level3">
<h3 class="hasAnchor">
<a href="#optional" class="anchor"></a>OPTIONAL:</h3>
<p>If you are curious and things are going well, do the optional activities. These are completely optional</p>
<div id="optional-the-summary-command-on-an-lm-object" class="section level4">
<h4 class="hasAnchor">
<a href="#optional-the-summary-command-on-an-lm-object" class="anchor"></a>Optional: The summary command on an lm() object</h4>
<p>Look at the output and how it compares to what we did with anova() on the two models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model.null)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ 1, data = antlers)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -289.9 -109.0   12.5  126.5  283.4 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   635.92      29.31    21.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 160.5 on 29 degrees of freedom</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model.alt)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ diet, data = antlers)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -322.09 -103.31   14.16   99.22  313.33 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   605.97      46.18  13.123 3.12e-13 ***
## dietHi.Lo     -43.98      65.30  -0.673   0.5064    
## dietLo.Hi     133.83      65.30   2.049   0.0503 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 146 on 27 degrees of freedom
## Multiple R-squared:  0.2296, Adjusted R-squared:  0.1725 
## F-statistic: 4.022 on 2 and 27 DF,  p-value: 0.02958</code></pre>
</div>
<div id="optional-the-anova-command-on-a-single-lm-object" class="section level4">
<h4 class="hasAnchor">
<a href="#optional-the-anova-command-on-a-single-lm-object" class="anchor"></a>Optional: The anova command on a single lm() object</h4>
<p>Look at the output and how it compares to what we did with anova() on the two models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(model.alt)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: mass
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## diet       2 171543   85772  4.0225 0.02958 *
## Residuals 27 575719   21323                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="optional-change-how-model-is-defined" class="section level4">
<h4 class="hasAnchor">
<a href="#optional-change-how-model-is-defined" class="anchor"></a>Optional: Change how model is defined</h4>
<p>We’ll add a “-1” to the model statemnt and call summary(). How does this differe from summary(model.alt)? (The difference is subtle…)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model.alt.<span class="dv">2</span>  &lt;-<span class="st"> </span><span class="kw">lm</span>(mass <span class="op">~-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>diet, <span class="dt">data =</span> antlers)

<span class="kw">summary</span>(model.alt.<span class="dv">2</span>)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ -1 + diet, data = antlers)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -322.09 -103.31   14.16   99.22  313.33 
## 
## Coefficients:
##           Estimate Std. Error t value Pr(&gt;|t|)    
## dietHi.Hi   605.97      46.18   13.12 3.12e-13 ***
## dietHi.Lo   561.99      46.18   12.17 1.80e-12 ***
## dietLo.Hi   739.80      46.18   16.02 2.59e-15 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 146 on 27 degrees of freedom
## Multiple R-squared:  0.9553, Adjusted R-squared:  0.9503 
## F-statistic: 192.3 on 3 and 27 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="optional-plotting-model-diagnostics" class="section level4">
<h4 class="hasAnchor">
<a href="#optional-plotting-model-diagnostics" class="anchor"></a>Optional: Plotting model diagnostics</h4>
<p>We can plot the “model diagnostics” using plot(). We will go into further details on this topic in the future.</p>
<p>Note: the par(mfrow = c(2,2)) is a bit of cryptic R code that sets up the plotting window to have 4 panels</p>
<p>Also note: we’ll use the ggplot2 addon library ggfortify for this, which has a fabulous function autoplot()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#load the library</span>
<span class="kw">library</span>(ggfortify)

<span class="co">#plot the residuals</span>
<span class="kw">autoplot</span>(model.alt)</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-25-1.png" width="480"></p>
</div>
</div>
</div>
<div id="part-3-pairwise-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#part-3-pairwise-comparisons" class="anchor"></a>Part 3: Pairwise comparisons</h2>
<p>The traditional way of doing a 1-way ANOVA is to follow up a “significant” Omnibus test with seperate t-tests that compare pair of means. This is called doing “pairwise” comparison - you go pair by pair doing t-tests.</p>
<p>The function pairwise.t.test() is used. Note that p.adjust.method = “none” line, which means we are given raw p-values that have <em>not</em> been corrected fro muotipel comparisons (see below)</p>
<div id="get-pairwise-p-valeus" class="section level3">
<h3 class="hasAnchor">
<a href="#get-pairwise-p-valeus" class="anchor"></a>13-15) Get pairwise p-valeus</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwise.t.test</span>(<span class="dt">x =</span> antlers<span class="op">$</span>mass,
                <span class="dt">g =</span> antlers<span class="op">$</span>diet,
                <span class="dt">p.adjust.method =</span> <span class="st">"none"</span>)</code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  antlers$mass and antlers$diet 
## 
##       Hi.Hi Hi.Lo
## Hi.Lo 0.506 -    
## Lo.Hi 0.050 0.011
## 
## P value adjustment method: none</code></pre>
</div>
</div>
<div id="part-4-pairwise-comparisons-correcting-for-multiple-comparisons-effect-sizes" class="section level2">
<h2 class="hasAnchor">
<a href="#part-4-pairwise-comparisons-correcting-for-multiple-comparisons-effect-sizes" class="anchor"></a>Part 4: Pairwise comparisons, correcting for multiple comparisons, &amp; effect sizes</h2>
<p>The more t-tests you do, the more likely you are to get a “Significant” (low) p-value just due to chance. Rememeber - the definition of a p-value is such that it always leaves open the possiblity that the patterns you see are just due to random noise. This is called the “problem of multiple comparisons.”</p>
<p>One way that is advocated to to deal with this issue of multiple comparisons is to increase p-values. One way of doing this this is to use a “Bonferroni” correction. This can be done using pairwise.t.test() and setting p.adjust.method = “bonferroni”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwise.t.test</span>(<span class="dt">x =</span> antlers<span class="op">$</span>mass,
                <span class="dt">g =</span> antlers<span class="op">$</span>diet,
                <span class="dt">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  antlers$mass and antlers$diet 
## 
##       Hi.Hi Hi.Lo
## Hi.Lo 1.000 -    
## Lo.Hi 0.151 0.034
## 
## P value adjustment method: bonferroni</code></pre>
<div id="build-model-with-aov-function" class="section level3">
<h3 class="hasAnchor">
<a href="#build-model-with-aov-function" class="anchor"></a>17) Build model with aov() function</h3>
<p>When doing a 1-way ANOVA with three groups, a good option is to do a Tukey Test using the TukeyHSD() function. However, to do this you need first need to jump through a hoop: you need to redo the model model using the aov() function. (aov stands for “analysis of variance”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model.alt.aov &lt;-<span class="st"> </span><span class="kw">aov</span>(mass <span class="op">~</span><span class="st"> </span>diet, 
                     <span class="dt">data =</span> antlers)</code></pre></div>
</div>
<div id="get-p-values-with-tukeys-hsd" class="section level3">
<h3 class="hasAnchor">
<a href="#get-p-values-with-tukeys-hsd" class="anchor"></a>18) Get p-values with Tukey’s HSD</h3>
<p>When the model is fit using aov() you can then use TukeyHSD(). This gives you p-values for each set of pairwise comparisons and, more importantly effect sizes and their confidence intervals for each comparison. Importantly, the p-values and CIs have been increased to deal with the fact that you are making multiple comparisons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TukeyHSD</span>(model.alt.aov)</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = mass ~ diet, data = antlers)
## 
## $diet
##                  diff        lwr      upr     p adj
## Hi.Lo-Hi.Hi -43.97973 -205.89517 117.9357 0.7807326
## Lo.Hi-Hi.Hi 133.83308  -28.08236 295.7485 0.1198088
## Lo.Hi-Hi.Lo 177.81281   15.89737 339.7282 0.0292046</code></pre>
</div>
<div id="plot-effect-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-effect-sizes" class="anchor"></a>19) Plot effect sizes</h3>
<p>The wildlifeR package contains a function that makes nice plots (IMHO) of the output of the TukeyHSD function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))

tukey.out &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(model.alt.aov)

<span class="kw"><a href="../reference/plotTukeysHSD.html">plotTukeysHSD</a></span>(tukey.out)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="ANOVA_deer_antlers_files/figure-html/unnamed-chunk-30-1.png" width="480"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#part-1-summary-stats-plotting-means">Part 1: Summary stats &amp; plotting means</a></li>
      <li><a href="#plot-the-3-mean-values">6) Plot the 3 mean values</a></li>
      <li><a href="#part-2-omnibus-anova-test">Part 2: Omnibus ANOVA test</a></li>
      <li><a href="#conduct-the-omnibus-test-and-get-the-anova-output">9-12) Conduct the Omnibus test and get the ANOVA output</a></li>
      <li><a href="#part-3-pairwise-comparisons">Part 3: Pairwise comparisons</a></li>
      <li><a href="#part-4-pairwise-comparisons-correcting-for-multiple-comparisons-effect-sizes">Part 4: Pairwise comparisons, correcting for multiple comparisons, &amp; effect sizes</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Brouwer Nathan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
